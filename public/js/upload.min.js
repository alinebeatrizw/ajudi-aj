class TentativaDeUpoload{constructor(){this.intervalo=1e3,this.IntervaloMaximo=6e4}proximoIntervalo(){var t=2*this.intervalo+this.gerarIntAleatorio(0,1e3);return Math.min(t,this.IntervaloMaximo)}gerarIntAleatorio(t,e){return Math.floor(Math.random()*(e-t+1)+t)}}class Uploader{constructor(t){var e=function(){};if(this.file=t.file,this.contentType=t.contentType||this.file.type||"application/octet-stream",this.metadata=t.metadata||{title:this.file.name,mimeType:this.contentType},this.token=t.token,this.onComplete=t.onComplete||e,this.progresso=t.progresso||e,this.onError=t.onError||e,this.offset=t.offset||0,this.chunkSize=t.chunkSize||0,this.tentativaDeUpoload=new TentativaDeUpoload,this.url=t.url,!this.url){var o=t.params||{};o.uploadType="resumable",this.url=this.buildUrl_(t.fileId,o,t.baseUrl)}this.httpMethod=t.fileId?"PUT":"POST"}upload(){var t=new XMLHttpRequest;t.open(this.httpMethod,this.url,!0),t.setRequestHeader("Authorization","Bearer "+this.token),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("X-Upload-Content-Length",this.file.size),t.setRequestHeader("X-Upload-Content-Type",this.contentType),t.onload=function(t){if(t.target.status<400){var e=t.target.getResponseHeader("Location");this.url=e,this.enviaArquivo()}else this.erroNoUpload(t)}.bind(this),t.onerror=this.erroNoUpload.bind(this),t.send(JSON.stringify(this.metadata))}enviaArquivo(){var t=this.file,e=this.file.size,o=new XMLHttpRequest;o.open("PUT",this.url,!0),o.setRequestHeader("Content-Type",this.contentType),o.setRequestHeader("Content-Range","bytes "+this.offset+"-"+(e-1)+"/"+this.file.size),o.setRequestHeader("X-Upload-Content-Type",this.file.type),o.upload&&o.upload.addEventListener("progress",this.progresso),o.onload=this.sucessoNoUpload.bind(this),o.onerror=this.erroNoUpload.bind(this),o.send(t)}sucessoNoUpload(t){200!=t.target.status&&201!=t.target.status||this.onComplete(t.target.response)}erroNoUpload(t){t.target.status&&t.target.status<500&&this.onError(t.target.response)}buildQuery_(t){return t=t||{},Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&")}buildUrl_(t,e,o){var s=o||"https://www.googleapis.com/upload/drive/v2/files/";t&&(s+=t);var i=this.buildQuery_(e);return i&&(s+="?"+i),s}}